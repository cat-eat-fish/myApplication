(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/application/business/business"],{"029b":function(e,t,s){},4157:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s("43ce"),n=s("33bf"),i=s("1ea5"),o=function(){return s.e("components/uni-popup/uni-popup").then(s.bind(null,"b072"))},r=function(){return s.e("components/tki-file-manager").then(s.bind(null,"16fd"))},u={components:{tkiFileManager:r,uniPopup:o},data:function(){return{index:0,array:[],arrayInfo:[],index2:0,array2:[],array2Info:[],index3:0,array3:[],array3Info:[],index3_1:0,array3_1:[],array3_1Info:[],index4:0,array4:[],array4Info:[],index5:0,array5:[],array5Info:[],index6:0,array6:[],array6Info:[],index7:0,array7:[],array7Info:[],index7_1:0,array7_1:[],array7_1Info:[],businessName:"评级认定审批",businessMechanism:"孝义农商行全辖汇总",isdis:!1,businessData:{title:"",symboltablecode:"评级",customer_name:"",customer_id:"",cust_type:"",controlPer:"",evaluate_modle:"",first_level:"",applay_date:"",applay_reason:"",userIds:"",userIds2:"",lastLevel:""},type:"",getUserInfo:[],list:[],path:[],userIds:"",seq:"",isUp:!1,ishold:!1}},onNavigationBarButtonTap:function(e){this.isKeep()},onLoad:function(){this.businessData.applay_date=(0,n.formateDate)(new Date,"Y-M-D");var t=this;e.request({url:"http://"+(0,a.baseIp)()+"/ams/system/distribute.htm?module=pullDown&XLX=sbType",success:function(e){var s=e.data;t.arrayInfo=s.object,s=s.object.map(function(e){return e.name}),t.array=s,t.businessData.title=t.arrayInfo[0].code}}),e.request({url:"http://"+(0,a.baseIp)()+"/ams/system/distribute.htm?module=pullDown&XLX=customerType",success:function(e){var s=e.data;t.array2Info=s.object,s=s.object.map(function(e){return e.name}),s.unshift("请选择客户类型"),t.array2=s}}),e.request({url:"http://"+(0,a.baseIp)()+"/ams/system/distribute.htm?module=pullDown&XLX=level_modle",success:function(e){var s=e.data;t.array4Info=s.object,s=s.object.map(function(e){return e.name}),s.unshift("请选择拟初评结果"),t.array4=s}}),e.request({url:"http://"+(0,a.baseIp)()+"/ams/system/distribute.htm?module=pullDown&XLX=levelType",success:function(e){var s=e.data;t.array6Info=t.array5Info=s.object,s=s.object.map(function(e){return e.name});var a=[].concat(s);s.unshift("请选择拟初评结果"),a.unshift("请选择上季度拟初评结果"),t.array5=s,t.array6=a}}),e.request({url:"http://"+(0,a.baseIp)()+"/ams/system/distribute.htm?module=check_dept",success:function(e){var s=e.data;t.array3Info=t.array7Info=s.object;var a=s.object.map(function(e){return e.dept_name}),n=[].concat(a);a.unshift("请选择营销责任人"),t.array3=a,n.unshift("请选择协助调查岗"),t.array7=n}})},beforeDestroy:function(){return!1},methods:{bindPickerChange:function(e){this.index=e.target.value,this.businessData.title=this.arrayInfo[e.target.value].code},bindPickerChange2:function(t){this.index2=t.target.value,0!=t.target.value?this.businessData.cust_type=this.array2Info[t.target.value-1].code:e.showToast({title:"选择失败",icon:"none"})},bindPickerChange3:function(t){var s=this;this.index3=t.target.value,0!=t.target.value?e.request({url:"http://".concat((0,a.baseIp)(),"/ams/system/distribute.htm?module=check_person&dept_id=").concat(s.array3Info[t.target.value].id-1),success:function(t){var a=t.data;if(0==a.object.length)e.showToast({title:"选择失败，请重新选择！",icon:"none"}),s.index3=0,s.array3_1=[],s.businessData.userIds2="";else{s.array3_1Info=a.object,e.showToast({title:"请选择具体信息",icon:"none"});var n=a.object.map(function(e){return e.dept_name});s.array3_1=n,s.businessData.userIds2=String(s.array3_1Info[s.index3_1].id)}}}):e.showToast({title:"选择失败",icon:"none"})},bindPickerChange3_1:function(e){this.index3_1=e.target.value,this.businessData.userIds2=String(this.array3_1Info[this.index3_1].id)},bindPickerChange4:function(t){this.index4=t.target.value,0!=t.target.value?this.businessData.evaluate_modle=this.array4Info[t.target.value-1].code:e.showToast({title:"选择失败",icon:"none"})},bindPickerChange5:function(t){this.index5=t.target.value,0!=t.target.value?this.businessData.first_level=this.array5Info[t.target.value-1].code:e.showToast({title:"选择失败",icon:"none"})},bindPickerChange6:function(t){this.index6=t.target.value,0!=t.target.value?this.businessData.lastLevel=this.array6Info[t.target.value-1].code:e.showToast({title:"选择失败",icon:"none"})},bindPickerChange7:function(t){var s=this;this.index7=t.target.value,0!=t.target.value?e.request({url:"http://".concat((0,a.baseIp)(),"/ams/system/distribute.htm?module=check_person&dept_id=").concat(s.array3Info[t.target.value].id-1),success:function(t){var a=t.data;if(0==a.object.length)e.showToast({title:"选择失败，请重新选择！"}),s.array7_1=[],s.businessData.userIds="";else{s.array7_1Info=a.object,e.showToast({title:"请选择具体信息",icon:"none"});var n=a.object.map(function(e){return e.dept_name});s.array7_1=n,s.businessData.userIds=String(s.array7_1Info[s.index7_1].id)}}}):e.showToast({title:"选择失败",icon:"none"})},bindPickerChange7_1:function(e){this.index7_1=e.target.value,this.businessData.userIds=String(this.array7_1Info[this.index7_1].id)},doUpload:function(){if(this.ishold)if(0!=this.path.length){e.showLoading({title:"上传中",mask:!0});var t=[];this.path.map(function(e,s){t[s]={name:s+1,uri:""}}),this.path.map(function(e,s){t[s].uri=e});var s=this,n="http://".concat((0,a.baseIp)(),"/ams/system/distribute.htm?module=PJupload&userId=").concat((0,i.getUserInfo)().userId,"&mainId=").concat(s.seq);e.uploadFile({url:n,filePath:"",name:"",files:t,success:function(t){if("string"==typeof t.data)var a=JSON.parse(t.data);else a=t.data;1==a.code&&(s.isUp=!0,e.hideLoading(),e.showToast({title:a.message,mask:!0}))}})}else e.showToast({title:"请先选择资料！",icon:"none"});else e.showModal({title:"您还没有保存",content:"您还没有保存数据，请先保存！",success:function(e){e.confirm||e.cancel}})},togglePopup:function(e){this.type=e},submitAcce:function(){if(this.ishold)if(this.isUp){var t=this;e.showLoading({title:"提交中",mask:!0}),e.request({url:"http://".concat((0,a.baseIp)(),"/ams/system/distribute.htm?module=submitApp&id=").concat(t.seq,"&userIds=").concat(t.userIds),success:function(t){var s=t.data;e.hideLoading(),1==s.code&&(e.showToast({title:s.message,duration:3e3,mask:!0}),setTimeout(function(){e.reLaunch({url:"/pages/tabBar/information/information"})},3e3))},fail:function(e){console.log(e," at pages\\application\\business\\business.vue:550")}})}else e.showModal({title:"您还没有上传资料",content:"您还没有上传资料，请先上传！",success:function(e){e.confirm||e.cancel}});else e.showModal({title:"您还没有保存",content:"您还没有保存数据，请先保存！",success:function(e){e.confirm||e.cancel}})},getName:function(e,t){this.businessData.customer_name=this.getUserInfo[t].customer_name,this.businessData.customer_id=this.getUserInfo[t].customer_id,this.type="",this.isdis=!0},openFile:function(){this.$refs.filemanager._openFile()},resultPath:function(e){this.path.push("file://".concat(e))},delList:function(e){this.path.splice(e.target.dataset.value,1)},retrieval:function(){var t=this;if(""==this.businessData.customer_name)e.showToast({title:"请输入客户名称",duration:2e3,icon:"none"});else{e.showLoading({title:"检索中",mask:!0});var s="http://".concat((0,a.baseIp)(),"/ams/system/distribute.htm?module=checkCustomer&customerName=").concat(t.businessData.customer_name);e.request({url:s,success:function(s){e.hideLoading();var a=s.data;if(0==a.object.length)t.type="",t.list=a.object,e.showToast({title:"暂无数据"});else{t.getUserInfo=a.object;var n=a.object.map(function(e){return e.customer_name});t.type="middle-list",t.list=n}},fail:function(t){console.log(t," at pages\\application\\business\\business.vue:608"),e.hideLoading()}})}},isKeep:function(){if(""!=this.businessData.customer_name)if(""!=this.businessData.customer_id)if(""!=this.businessData.cust_type)if(""!=this.businessData.controlPer)if(""!=this.businessData.userIds2)if(""!=this.businessData.evaluate_modle)if(""!=this.businessData.first_level)if(""!=this.businessData.lastLevel)if(""!=this.businessData.applay_date)if(""!=this.businessData.userIds){var t=this.businessData;t.user_id=String((0,i.getUserInfo)().userId),t.bus_code="";var s="http://".concat((0,a.baseIp)(),'/ams/system/distribute.htm?module=saveBusiness&business={user_id:"').concat(t.user_id,'", title:"').concat(t.title,'",symboltablecode:"01",customer_name:"').concat(t.customer_name,'",customer_id:"').concat(t.customer_id,'",cust_type:"').concat(t.cust_type,'",bus_code:"').concat(t.bus_code,'",evaluate_modle:"').concat(t.evaluate_modle,'",first_level:"').concat(t.first_level,'",applay_date:"').concat(t.applay_date,'",applay_reason:"').concat(t.applay_reason,'",userIds:"').concat(t.userIds,'",userIds2:"').concat(t.userIds2,'",lastLevel:"').concat(t.lastLevel,'",controlPer:"').concat(t.controlPer,'"}'),n=this;e.showModal({title:"是否保存",content:"您还没有保存数据，是否保存？",success:function(t){t.confirm&&(e.showLoading({title:"保存中",mask:!0}),e.request({url:s,success:function(t){var s=t.data;1==s.code&&(e.hideLoading(),e.showToast({title:"请及时提交!",mask:!0,duration:2e3}),n.userIds=s.object.userIds,n.ishold=!0,n.seq=s.object.seq)},fail:function(t){console.log(t," at pages\\application\\business\\business.vue:725"),e.hideLoading()}}))}})}else e.showToast({title:"请选择协助调查岗",icon:"none"});else e.showToast({title:"请选择审评时间",icon:"none"});else e.showToast({title:"请选择上季度拟初评结果",icon:"none"});else e.showToast({title:"请选择拟初评结果",icon:"none"});else e.showToast({title:"请选择评级模型",icon:"none"});else e.showToast({title:"请选择营销责任人",icon:"none"});else e.showToast({title:"请填写实际控制人",icon:"none"});else e.showToast({title:"请选择客户类型",icon:"none"});else e.showToast({title:"请检索客户id",icon:"none"});else e.showToast({title:"请检索客户名称",icon:"none"})}}};t.default=u}).call(this,s("6e42")["default"])},"455b":function(e,t,s){"use strict";s.r(t);var a=s("4157"),n=s.n(a);for(var i in a)"default"!==i&&function(e){s.d(t,e,function(){return a[e]})}(i);t["default"]=n.a},"5bee":function(e,t,s){"use strict";var a=s("029b"),n=s.n(a);n.a},"7cdb":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},n=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return n})},"967a":function(e,t,s){"use strict";s.r(t);var a=s("7cdb"),n=s("455b");for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);s("5bee");var o=s("2877"),r=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,null,null);t["default"]=r.exports}},[["92e7","common/runtime","common/vendor"]]]);