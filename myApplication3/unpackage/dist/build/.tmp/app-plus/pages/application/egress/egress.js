(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/application/egress/egress"],{2952:function(t,e,a){"use strict";var n=a("5ad9"),i=a.n(n);i.a},"5ad9":function(t,e,a){},"6f01":function(t,e,a){"use strict";a.r(e);var n=a("f7f3"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);e["default"]=i.a},"88f1":function(t,e,a){"use strict";a.r(e);var n=a("f6e2"),i=a("6f01");for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);a("2952");var s=a("2877"),u=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=u.exports},f6e2:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},f7f3:function(module,exports,__webpack_require__){"use strict";(function(uni){Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _util=__webpack_require__("f035"),_config=__webpack_require__("43fa"),_service=__webpack_require__("8938"),cpimg=function(){return __webpack_require__.e("components/cpimg").then(__webpack_require__.bind(null,"8de9"))},uniNumberBox=function(){return __webpack_require__.e("components/uni-number-box/uni-number-box").then(__webpack_require__.bind(null,"280f"))},_default={components:{uniNumberBox:uniNumberBox,cpimg:cpimg},data:function(){return{type:"",startDate:(0,_util.getDate)("start"),endDate:(0,_util.getDate)("end"),index:0,array:["公事"],arrayInfo:[{code:1,title:"公事"}],name:"外出审批",dataInfo:{title:1,jg:"",name:"",station:"",bm:"",phone:"",num:0,cause:"",time:(0,_util.formateDate)(new Date,"h:min"),date:(0,_util.formateDate)(new Date,"Y-M-D"),endtime:(0,_util.formateDate)(new Date,"h:min"),enddate:(0,_util.formateDate)(new Date,"Y-M-D"),img:""},img:"",dept_id:"",seq:"",ishold:!1}},onLoad:function(){this.getBm()},methods:{getImg:function(){var t=this;t.$refs.cpimgs._changImg()},cpimgOk:function(t){uni.hideLoading(),this.dataInfo.img=t,this.img=t},cpimgErr:function(t){console.log(t," at pages\\application\\egress\\egress.vue:147")},bindDateChange:function(t){this.dataInfo.date=t.target.value},bindTimeChange:function(t){this.dataInfo.time=t.target.value},bindDateChange2:function(t){this.dataInfo.enddate=t.target.value},bindTimeChange2:function(t){this.dataInfo.endtime=t.target.value},bindPickerChange:function(t){this.index=t.target.value,this.dataInfo.title=this.arrayInfo[t.target.value].code},getBm:function(){var t=this,e="".concat((0,_config.baseIp)(),"/ams/system/distribute.htm?module=getUserId_YD&userId=").concat((0,_service.getUserInfo)().userName);uni.request({url:e,success:function(e){var a=e.data.object[0];t.type=a.type,t.dataInfo.jg=t.dataInfo.bm=a.dept_name,t.dataInfo.name=a.name,t.dataInfo.phone=a.mobie,t.dataInfo.station=a.post,t.dept_id=a.dept_id}})},change:function(t){this.dataInfo.num=t},isKeep:function isKeep(){if(""!=this.dataInfo.cause)if(""!=this.dataInfo.img){var uploadData=this.dataInfo;uploadData.start="".concat(uploadData.date," ").concat(uploadData.time);var url="".concat((0,_config.baseIp)(),"/ams/system/distribute.htm?module=addOut_YD&hr=true"),that=this,data={file:that.img,id:(0,_service.getUserInfo)().userName,type:that.type,branchId:that.dept_id,busType:"08",name:uploadData.name,position:uploadData.station,mobie:uploadData.phone,outDuration:uploadData.num,outType:uploadData.title,applayDate1:uploadData.start,outReason:uploadData.cause},that=this;uni.showModal({title:"是否保存",content:"保存成功后，请直接提交受理！",success:function success(res){res.confirm&&(uni.showLoading({title:"保存中",mask:!0}),uni.request({url:url,method:"POST",data:data,success:function success(Res){uni.hideLoading();var data=Res.data;"string"==typeof data&&(data=eval("("+data+")")),"object"==typeof data&&(1==data.code?(that.ishold=!0,that.seq=data.seq,uni.showToast({title:data.message,mask:!0})):uni.showToast({title:data.message,icon:"none",mask:!0}))},fail:function(t){uni.hideLoading(),uni.showToast({title:t.errMsg,icon:"none"})}}))}})}else uni.showToast({title:"请选择上传图片",icon:"none"});else uni.showToast({title:"请输入外出事由",icon:"none"})},submitAcce:function(){if(this.ishold){uni.showLoading({title:"提交中",mask:!0});var t=this,e="".concat((0,_config.baseIp)(),"/ams/system/distribute.htm?module=submitOutMainInfo_YD&Id=").concat(t.seq,"&userId=").concat((0,_service.getUserInfo)().userName,"&hr=true");uni.request({url:e,success:function(t){var e=t.data;uni.hideLoading(),1==e.code&&(uni.showToast({title:e.message,mask:!0,duration:3e3}),setTimeout(function(){uni.reLaunch({url:"/pages/tabBar/information/information"})},3e3))},fail:function(t){}})}else uni.showModal({title:"您还没有保存",content:"您还没有保存数据，请先保存！",success:function(t){t.confirm?console.log("用户点击确定"," at pages\\application\\egress\\egress.vue:261"):t.cancel&&console.log("用户点击取消"," at pages\\application\\egress\\egress.vue:263")}})}}};exports.default=_default}).call(this,__webpack_require__("6e42")["default"])}},[["ecc2","common/runtime","common/vendor"]]]);